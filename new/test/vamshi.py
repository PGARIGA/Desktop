import requests
import json

def check_ip_reputation(ip_address, api_key):
    url = f'https://api.abuseipdb.com/api/v2/check?ipAddress={ip_address}'
    headers = {'Key': api_key, 'Accept': 'application/json'}
    
    response = requests.get(url, headers=headers)
    if response.status_code == 200:
        data = json.loads(response.text)
        is_malicious = data['data']['isWhitelisted'] == 0 and data['data']['abuseConfidenceScore'] >= 75
        return is_malicious, data['data']['abuseConfidenceScore']
    else:
        return None

# API Key from AbuseIPDB
api_key = '4c5ebbf71d455408739bafd920dd2aaf80d4dab9de88d4053c2eed58914336d8c7077f3d4e927f37'

# List of IP addresses to check
ip_addresses = ['172.94.57.253', '5.254.53.54', '103.109.103.99', '3.132.30.131', '114.55.72.248', '63.162.108.209', '63.160.28.192', '63.162.110.137', '63.160.28.182', '63.160.66.121', '63.160.28.24', '63.160.11.171', '63.160.11.212', '63.162.111.8', '63.160.10.179', '63.162.213.93', '45.83.22.185', '185.153.151.105', '87.249.135.117', '217.212.245.67', '171.22.108.204', '64.42.178.26', '63.162.213.176', '63.160.28.42', '63.162.110.63', '63.160.66.147', '63.160.28.12', '63.160.42.11', '63.160.28.114', '63.160.30.99', '63.160.31.127', '63.162.109.112', '63.160.10.120', '63.160.28.56', '63.162.213.32', '63.162.213.127', '63.162.212.245', '63.162.111.5', '63.160.42.207', '63.162.111.29', '63.160.10.226', '63.162.111.42', '45.136.155.21', '63.161.13.129', '146.70.130.150', '85.208.3.184', '146.70.120.86', '149.34.244.245', '185.92.210.43', '146.70.155.60', '146.70.111.150', '31.171.155.214', '185.174.159.190', '184.170.249.65', '63.160.10.233', '2a01:4f9:c011:add0::1', '49.12.38.176', '103.76.164.182', '172.111.128.253', '37.19.217.102', '63.160.28.33', '185.94.192.150', '154.57.3.32', '130.185.85.106', '46.29.2.167', '5.188.95.19', '139.99.130.188', '195.177.216.97', '129.232.209.234', '31.40.212.171', '80.239.140.197', '185.64.104.47', '80.248.243.202', '84.17.37.57', '23.83.131.30', '104.243.253.30', '5.161.220.140', '63.160.11.175', '63.160.66.122', '63.161.13.250', '116.206.73.27', '5.161.119.106', '63.161.13.120', '146.70.103.158', '5.254.89.120', '63.160.28.198', '146.70.126.30', '104.250.176.10', '63.160.11.45', '164.90.212.28', '156.146.63.69', '178.175.130.2', '165.225.210.219', '194.110.114.118', '63.160.10.92', '162.212.156.153', '200.30.138.54', '188.72.101.12', '63.160.42.102', '63.160.66.101', '146.70.109.190', '41.76.145.136', '63.160.28.61', '63.162.109.222', '63.162.111.166', '91.232.30.182', '38.54.80.223', '129.227.96.82', '80.239.140.66', '45.162.230.58', '185.205.186.84', '38.54.32.151', '5.255.96.154', '89.187.160.146', '45.252.191.33', '64.226.113.87', '149.102.251.21', '165.225.206.248', '146.70.128.55', '63.161.13.137', '172.107.248.246', '209.38.210.200', '213.21.215.178', '63.160.28.201', '165.227.151.71', '63.162.109.74', '63.162.110.135', '164.92.254.92', '206.123.151.66', '63.162.109.126', '120.79.86.123', '138.199.31.27', '184.178.172.18', '63.160.66.104', '63.160.11.221', '49.13.2.17', '63.160.28.171', '63.162.111.69', '192.252.216.81', '144.49.99.176', '63.162.213.235', '63.160.28.77', '212.109.223.78', '65.108.242.98', '63.160.30.36', '63.162.212.216', '63.162.109.128', '41.208.71.192', '201.172.241.247', '209.205.213.138 178.17.172.98', '20.251.119.50', '63.160.10.195', '138.199.55.216', '60.190.195.146', '172.111.175.241', '72.210.221.197', '5.161.213.21', '72.206.181.123', '45.9.15.60', '5.254.46.89', '149.34.249.72', '63.160.42.38', '5.254.106.30', '63.160.10.213', '101.132.70.106', '169.150.205.98', '45.83.22.151', '63.160.28.243', '192.111.139.165', '37.221.171.213', '64.145.93.198', '146.70.89.60', '138.199.60.122', '37.221.173.247', '67.213.219.209', '63.162.109.147', '63.162.213.209', '63.160.10.81', '164.92.178.83', '138.199.31.8', '138.199.34.213', '138.199.42.210', '172.94.104.249', '194.37.96.247', '45.134.142.85', '146.70.55.150', '62.14.234.232', '27.50.76.165', '63.160.42.197', '63.160.30.14', '63.161.13.55', '45.250.255.25', '67.213.219.232', '181.119.160.58', '194.132.123.2', '38.54.79.122', '23.106.58.10', '201.217.220.26', '185.246.209.88', '38.54.125.60', '62.115.255.163', '103.84.192.228', '193.187.91.20', '195.181.163.129', '223.165.4.215', '217.199.103.163', '80.239.199.101', '51.68.155.141', '130.185.255.24', '213.227.149.249', '172.107.194.177', '103.254.155.210', '63.160.42.123', '199.58.185.9', '5.254.76.150', '149.50.211.73', '63.160.42.104', '173.245.209.247', '63.160.28.84', '216.131.75.250', '31.220.89.24', '63.160.11.5', '63.161.13.78', '68.71.254.6', '63.160.30.118', '185.147.212.251', '72.221.232.152', '63.160.42.174', '190.104.26.227', '122.155.165.191', '5.161.201.72', '95.216.156.131', '149.34.252.35', '63.160.10.186', '157.230.95.47', '37.120.192.154', '63.160.28.230', '63.162.111.116', '154.202.110.53', '154.202.109.120', '154.202.110.155', '154.202.108.9', '154.202.110.79', '154.202.100.240', '63.160.11.147', '154.202.109.222', '184.178.172.17', '142.132.225.88', '63.162.111.9', '63.160.66.171', '2a01:4f9:c012:72c9::1', '63.162.111.48', '2a01:4f9:c011:9e75::1', '200.41.12.246', '63.162.213.168', '5.161.185.131', '63.160.28.72', '63.160.28.143', '154.202.109.152', '154.202.110.17', '63.162.213.21', '63.160.42.222', '63.160.42.99', '206.123.130.30', '154.202.108.103', '45.74.55.30', '154.202.110.159', '154.202.108.153', '154.202.110.119', '209.127.76.7', '154.202.102.107', '154.202.108.171', '154.202.108.33', '154.202.109.136', '154.202.108.163', '154.202.110.49', '154.202.110.27', '154.202.110.191', '154.202.108.197', '154.202.109.128', '154.202.108.141', '154.202.109.160', '154.202.109.72', '154.202.102.135', '154.202.110.7', '209.127.76.131', '154.202.110.131', '154.202.109.126', '209.127.76.184', '94.130.229.212', '154.202.109.230', '154.202.108.47', '154.202.109.104', '154.202.110.93', '154.202.110.205', '154.202.110.107', '154.202.110.243', '154.202.108.79', '154.202.109.142', '209.127.76.38', '2a01:4f9:c011:af11::1', '105.158.200.45', '41.76.145.18', '20.62.193.30', '172.111.228.30', '85.114.161.187', '212.222.113.182', '105.73.203.99', '139.84.166.2', '51.195.67.86', '190.10.8.217', '92.223.88.171', '197.153.56.232', '71.19.249.30', '20.235.248.164', '69.162.82.62', '188.232.205.104', '201.59.171.42', '61.74.224.26', '92.81.47.254', '78.37.166.32', '38.44.71.238', '189.56.159.199']

for ip in ip_addresses:
    result = check_ip_reputation(ip, api_key)
    if result is not None:
        is_malicious, confidence_score = result
        if is_malicious:
            print(f'IP address {ip} is potentially malicious with a confidence score of {confidence_score}')
        else:
            print(f'IP address {ip} is not malicious with a confidence score of {confidence_score}')
    else:
        print(f'Failed to check reputation for IP address {ip}')
